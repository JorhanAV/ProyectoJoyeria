
<button class="back-button" (click)="goback()">← {{ 'VOLVER' | translate }}</button>

<div class="factura-contenedor" *ngIf="pedido">
  <h2 class="factura-titulo">{{ 'DETALLE_PEDIDO' | translate }} #{{ pedido.id }}</h2>

  <div class="factura-datos">
    <div><strong>{{ 'CLIENTE' | translate }}:</strong> {{ pedido.usuario.nombre_usuario }}</div>
    <div><strong>{{ 'FECHA' | translate }}:</strong> {{ pedido.fecha_pedido | date: 'longDate' }}</div>
    <div><strong>{{ 'DIRECCION_ENVIO' | translate }}:</strong> {{ pedido.direccion_envio }}</div>
    <div><strong>{{ 'METODO_PAGO' | translate }}:</strong> {{ pedido.metodoPago }}</div>
    <div><strong>{{ 'ESTADO' | translate }}:</strong> {{ pedido.estado }}</div>
  </div>

  <table class="factura-tabla">
    <thead>
      <tr>
        <th>{{ 'PRODUCTO' | translate }}</th>
        <th>{{ 'TIPO' | translate }}</th>
        <th>{{ 'DETALLES' | translate }}</th>
        <th>{{ 'CANTIDAD' | translate }}</th>
        <th>{{ 'PRECIO_UNITARIO' | translate }}</th>
        <th>{{ 'SUBTOTAL' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let prod of pedido.productos">
        <td>{{ prod.nombre }}</td>
        <td>
          {{prod.tipo}}
        </td>
        <td>
          <div *ngIf="prod.tipo === 'Producto personalizado'">
            <div *ngFor="let c of prod.criterios">
              <em>{{ c.criterio }}:</em> {{ c.seleccion }} (₡{{ c.precio_extra }})
            </div>
          </div>
          <div *ngIf="prod.tipo === 'Producto estándar'">-</div>
        </td>
        <td>{{ prod.cantidad }}</td>
        <td>
          ₡
          {{
            prod.tipo === 'Producto personalizado'
              ? prod.precio_base
              : prod.precio_unitario
          | number: '1.2-2' }}
        </td>
        <td>₡{{ prod.subtotal | number: '1.2-2' }}</td>
      </tr>
    </tbody>
  </table>

  <div class="factura-totales">
    <div><strong>{{ 'SUBTOTAL' | translate }}:</strong> ₡{{ pedido.subtotal | number: '1.2-2' }}</div>
    <div><strong>{{ 'IMPUESTOS' | translate }}:</strong> ₡{{ pedido.impuestos | number: '1.2-2' }}</div>
    <div class="total-final"><strong>{{ 'TOTAL' | translate }}:</strong> ₡{{ pedido.total | number: '1.2-2' }}</div>
