<div *ngIf="items.length > 0; else sinItems" class="carrito-container">
  <table class="tabla-carrito">
    <thead>
      <tr>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Subtotal</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of items">
        <td>{{ item.producto.nombre }}</td>
        <td>
          <button (click)="decrementarCantidad(item)">−</button>
          {{ item.cantidad }}
          <button (click)="incrementarCantidad(item)">+</button>
        </td>
        <td>₡{{ item.subtotal | number: '1.2-2' }}</td>
        <td>
          <button (click)="eliminarProducto(item.producto.id)">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="resumen-total">
    <p><strong>Subtotal:</strong> ₡{{ total | number: '1.2-2' }}</p>
    <p><strong>Impuestos (13%):</strong> ₡{{ (total * 0.13) | number: '1.2-2' }}</p>
    <p><strong>Total:</strong> ₡{{ (total * 1.13) | number: '1.2-2' }}</p>
  </div>

  <form #form="ngForm" (ngSubmit)="registrarPedido()" class="formulario-pedido">
    <label for="direccion">Dirección de envío:</label>
    <input
      type="text"
      id="direccion"
      name="direccion"
      [(ngModel)]="direccion_envio"
      required
    />
    <div *ngIf="form.submitted && !direccion_envio" class="error">
      La dirección de envío es obligatoria.
    </div>

    <label for="metodo_pago">Método de pago:</label>
    <select
      id="metodo_pago"
      name="metodo_pago"
      [(ngModel)]="metodo_pago"
      required
    >
      <option value="" disabled selected>Seleccione un método</option>
      <option value="Efectivo">Efectivo</option>
      <option value="Tarjeta">Tarjeta</option>
    </select>
    <div *ngIf="form.submitted && !metodo_pago" class="error">
      Debe seleccionar un método de pago.
    </div>

    <div class="acciones-carrito">
      <button type="button" (click)="vaciarCarrito()">Vaciar Carrito</button>
      <button type="submit">Confirmar Pedido</button>
    </div>
  </form>
</div>

<ng-template #sinItems>
  <p>Tu carrito está vacío.</p>
</ng-template>
